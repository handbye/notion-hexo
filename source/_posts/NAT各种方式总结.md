---
permalink: 2016/12/10/NAT-summary
tags:
  - NAT
layout: post
date: '2016-12-10 08:00:00'
categories:
  - 网络安全
  - NAT
home_cover: ''
title: NAT各种方式总结
---

## NAT简介


NAT（network address  translation）网络地址转换，主要用于实现位于内部网络的主机访问外部网络的功能。当局域网内的主机需要访问外部网络时，通过NAT技术可以将其私网地址转换为公网地址，并且多个私网用户可以共用一个公网地址，这样既可保证网络互通，又节省了公网地址。


NAT技术的出现原因主要是因为当前ipv4地址的耗尽，使用这个技术可以极大的减少公网地址的使用，另一种解决办法是ipv6技术（根本解决办法）。


我认为NAT技术的应用还可以隐藏内部网络的细节，一定程度上保护了内部网络。


## 静态NAT


静态NAT是将私网地址和公网地址进行一对一的映射，即当用户访问一个私网地址时，路由器会将这个私网地址转换为对应的公网地址，从而访问公网。


静态NAT是最初的网络地址转换思想，无法解决ipv4地址不足的问题。


## 动态NAT


动态NAT实现了私网地址和公网地址动态的映射。即我们可以定义一个公网地址池，当内部网络需要访问外网时，路由器可以随机的从公网地址池中取出一个公网ip和私网ip进行映射。当内部网络不需要访问外网时，这个地址会被回收进地址池，以供下一个主机进行映射。


动态NAT的方式更加灵活，但还是无法解决iPv4地址不足的问题，因为始终需要一个公网地址进行映射，有多少主机同时访问外网就需要多少公网ip进行映射。


## NAPT


NAPT（network address port translation）网络地址端口转换，此方法才真正的解决了ipv4地址不足的问题。NAPT可以将多个私网地址映射到同一个公网地址的不同端口号。以端口号的不同来区分不同的映射。


Easy ip 其实是一种特殊的NAPT，easy ip使用网关连接公网的接口ip地址来和私网ip地址进行映射。


## NAT SERVER


NAT在使内网用户访问公网的同时，也屏蔽了公网用户访问私网主机的需求。当一个私网需要向公网用户提供Web和SFTP服务时，私网中的服务器必须随时可供公网用户访问。


NAT服务器可以实现这个需求，但是需要配置服务器私网IP地址和端口号转换为公网IP地址和端口号并发布出去。路由器在收到一个公网主机的请求报文后，根据报文的目的IP地址和端口号查询地址转换表项。路由器根据匹配的地址转换表项，将报文的目的IP地址和端口号转换成私网IP地址和端口号，并转发报文到私网中的服务器


静态NAPT和NATserver的原理相同，只不过在配置上有微小的区别，此种方式也可以实现外网访问内网服务的需求。

